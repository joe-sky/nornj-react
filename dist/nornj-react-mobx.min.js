/*!
* NornJ-React-Mobx v5.0.0-rc.13
* (c) 2016-2019 Joe_Sky
* Released under the MIT License.
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("nornj"),require("mobx"),require("mobx-react")):"function"==typeof define&&define.amd?define(["nornj","mobx","mobx-react"],t):t((e=e||self).NornJ,e.mobx,e.mobxReact)}(this,function(e,t,r){"use strict";var n,B=o(require("nornj")),j=o(require("react")),P=require("mobx"),i=(n=require("../../extensionConfig"))&&n.__esModule?n:{default:n},_=require("../../../lib/utils");function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function N(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)t.indexOf(r=o[n])<0&&(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t.indexOf(r=o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var a=j.default.forwardRef(function(e,t){var r=e.MobxBindTag,n=e.mobxBindDirectiveOptions,i=n.tagName,o=n.context.$this,a=n.props,u=e._mobxBindValue,c=e._mobxBindAction,l=N(e,["MobxBindTag","mobxBindDirectiveOptions","_mobxBindValue","_mobxBindAction"]),f="value",s="onChange",d=B.default.getComponentConfig(i)||{},p=C(a&&a.arguments,"debounce");null!=d.valuePropName&&(f=d.valuePropName),null!=d.changeEventName&&(s=d.changeEventName);var v=u.value,b="select"===i&&l.multiple;(d.needToJS||b)&&(v=(0,P.toJS)(v));var m,g=l[s];if(p){var x=p.modifiers;m=(0,j.useRef)((0,_.debounce)(function(e){g.apply(o,e)},x&&+x[0]||100))}var h={};if(d.hasEventObject){var O=d.targetPropName||"value",y="input"===i&&"checkbox"===l.type;"input"===i&&"radio"===l.type?h.checked=l.value===v:y?h.checked=null!=v&&(B.default.isArrayLike(v)?0<=v.indexOf(l.value):v):h[f]=v,h[s]=function(e){e&&e.persist&&e.persist(),q(e.target[O],{target:e.target,value:u,args:arguments,changeEvent:g,action:c,valuePropName:f,emitChangeDebounced:m,isMultipleSelect:b,isCheckbox:y},o)}}else h[f]=v,h[s]=function(e){q(e,{value:u,args:arguments,changeEvent:g,action:c,valuePropName:f,emitChangeDebounced:m},o)};return j.default.createElement(r,E({},l,h,{ref:t}))});function q(e,t,r){var n=e;if(t.isMultipleSelect)n=B.default.arraySlice(t.target.options).filter(function(e){return e.selected}).map(function(e){return e.value});else if(t.isCheckbox){var i=t.value.value;n=B.default.isArrayLike(i)?(t.target.checked?i.push(e):i.splice(i.indexOf(e),1),i):t.target.checked}t.action?t.value.source["set".concat(B.default.capitalize(t.value.prop))](n,t.args):t.value.source[t.value.prop]=n,t.emitChangeDebounced?t.emitChangeDebounced.current(t.args):t.changeEvent&&t.changeEvent.apply(r,t.args)}function C(e,t){var r;return e&&e.every(function(e){return e.name!=t||(r=e,!1)}),r}(0,B.registerExtension)("mobxBind",function(e){var t=e.value();if(null==t)return t;var r=e.tagName,n=e.tagProps,i=e.props;(0,e.setTagName)(a),n.MobxBindTag=r,n.mobxBindDirectiveOptions=e,n._mobxBindValue=t,n._mobxBindAction=C(i&&i.arguments,"action")},i.default.mobxBind),(0,B.registerExtension)("mstBind",function(e){var t=e.value();if(null==t)return t;var r=e.tagName,n=e.tagProps;(0,e.setTagName)(a),n.MobxBindTag=r,n.mobxBindDirectiveOptions=e,n._mobxBindValue=t,n._mobxBindAction=!0},i.default.mstBind);var u=require("nornj"),c=s(require("react")),l=require("mobx-react-lite"),f=s(require("../../extensionConfig"));function s(e){return e&&e.__esModule?e:{default:e}}(0,u.registerExtension)("mobxObserver",function(e){return c.default.createElement(l.Observer,null,function(){return e.children()})},f.default.mobxObserver),e.registerComponent("mobx-Provider",r.Provider),e.registerFilter("toJS",function(e){return t.toJS(e)})});
