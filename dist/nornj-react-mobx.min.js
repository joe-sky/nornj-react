/*!
* NornJ-React-Mobx v5.0.0-rc.18
* (c) 2016-2019 Joe_Sky
* Released under the MIT License.
*/
!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(require("nornj"),require("mobx"),require("mobx-react")):"function"==typeof define&&define.amd?define(["nornj","mobx","mobx-react"],r):r((e=e||self).NornJ,e.mobx,e.mobxReact)}(this,function(e,r,t){"use strict";var n,B=o(require("nornj")),q=o(require("react")),C=require("mobx"),i=(n=require("../../extensionConfig"))&&n.__esModule?n:{default:n},E=require("../../../lib/utils");function o(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}function N(){return(N=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function k(e,r){if(null==e)return{};var t,n,i=function(e,r){if(null==e)return{};var t,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r.indexOf(t=o[n])<0&&(i[t]=e[t]);return i}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r.indexOf(t=o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var a=q.default.forwardRef(function(e,r){var t,n,i,o=e.MobxBindTag,a=e.mobxBindDirectiveOptions,u=a.tagName,l=a.context.$this,c=a.props,f=e._mobxBindValue,s=k(e,["MobxBindTag","mobxBindDirectiveOptions","_mobxBindValue"]),d="value",p="onChange",v=B.default.getComponentConfig(u)||{},b=(n="debounce",(t=c&&c.arguments)&&t.every(function(e){return e.name!=n||(i=e,!1)}),i);null!=v.valuePropName&&(d=v.valuePropName),null!=v.changeEventName&&(p=v.changeEventName);var m=f.value,g="select"===u&&s.multiple;(v.needToJS||g)&&(m=(0,C.toJS)(m));var x,h=s[p];if(b){var O=b.modifiers;x=(0,q.useRef)((0,E.debounce)(function(e){h&&h.apply(l,e)},O&&+O[0]||100))}var y={};if(v.hasEventObject){var j=v.targetPropName||"value",P="input"===u&&"checkbox"===s.type;"input"===u&&"radio"===s.type?y.checked=s.value===m:P?y.checked=null!=m&&(B.default.isArrayLike(m)?0<=m.indexOf(s.value):m):y[d]=m,y[p]=function(e){e&&e.persist&&e.persist(),D(e.target[j],{target:e.target,value:f,args:arguments,changeEvent:h,valuePropName:d,emitChangeDebounced:x,isMultipleSelect:g,isCheckbox:P},l)}}else y[d]=m,y[p]=function(e){D(e,{value:f,args:arguments,changeEvent:h,valuePropName:d,emitChangeDebounced:x},l)};return q.default.createElement(o,N({},s,y,{ref:r}))});function D(e,r,t){var n=e;if(r.isMultipleSelect)n=B.default.arraySlice(r.target.options).filter(function(e){return e.selected}).map(function(e){return e.value});else if(r.isCheckbox){var i=r.value.value;n=B.default.isArrayLike(i)?(r.target.checked?i.push(e):i.splice(i.indexOf(e),1),i):r.target.checked}var o=r.value.source["set".concat(B.default.upperFirst(r.value.prop))];o?o(n,r.args):r.value.source[r.value.prop]=n,r.emitChangeDebounced?r.emitChangeDebounced.current(r.args):r.changeEvent&&r.changeEvent.apply(t,r.args)}(0,B.registerExtension)("mobxBind",function(e){var r=e.value();if(null==r)return r;var t=e.tagName,n=e.tagProps;(0,e.setTagName)(a),n.MobxBindTag=t,n.mobxBindDirectiveOptions=e,n._mobxBindValue=r},i.default.mobxBind),B.default.extensions.mstBind=B.default.extensions.mobxBind;var u=require("nornj"),l=s(require("react")),c=require("mobx-react-lite"),f=s(require("../../extensionConfig"));function s(e){return e&&e.__esModule?e:{default:e}}(0,u.registerExtension)("mobxObserver",function(e){return l.default.createElement(c.Observer,null,function(){return e.children()})},f.default.mobxObserver),e.registerComponent("mobx-Provider",t.Provider),e.registerFilter("toJS",function(e){return r.toJS(e)})});
